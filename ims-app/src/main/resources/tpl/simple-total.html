<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <base href="${base}/">
    <link href="element/element.min.css" rel="stylesheet">
    <style>
        .total {
            margin: 0 auto;
            text-align: left;
            border: #CCC solid 1px;
            line-height: 60px;
            width: 277px;
            height: 181px;
            border-radius: 25px;
            padding: 20px;
        }

        .total:hover {
            box-shadow: 0px 0px 5px #888888;
        }

        .table {
            margin-top: 20px;
            display: flex;
            flex-direction: column;
        }

        .table-item {
            margin: 0 20px 0 20px;
        }

        .table-item-label {
            font-size: 20px;
            font-weight: bold;
            margin: 0 0 20px 0;
        }
        .total-box{
            text-align: center;
        }
    </style>
</head>
<body>
<div id="app">
    <template>
        <div class="total">
            <div class="total-box" style="font-weight: bolder;font-size: 25px">
                已经签到:{{countMap.has_sign_num}}
            </div>
            <div class="total-box" style="font-weight: bolder;font-size: 25px">
                必须签到总数:{{countMap.must_sign_num}}
            </div>
            <div class="total-box" style="font-weight: bolder;font-size: 25px">
                未签到总计:{{countMap.no_sign_count}}
            </div>
        </div>

        <div>

        </div>
        <div class="table">
            <div class="table-item">
                <div class="table-item-label"> 所有签到记录</div>
                <div>
                    <el-table
                            :data="countList.signRecordList"
                            height="250"
                            style="width: 100%">
                        <el-table-column
                                prop="dept_name"
                                label="学院"
                        >
                        </el-table-column>
                        <el-table-column
                                prop="grade_name"
                                label="年级"
                        >
                        </el-table-column>
                        <el-table-column
                                prop="teacher_name"
                                label="老师">
                        </el-table-column>
                        <el-table-column
                                prop="kc_name"
                                label="课程">
                        </el-table-column>
                        <el-table-column
                                prop="nick_name"
                                label="姓名">
                        </el-table-column>
                        <el-table-column
                                prop="sign_create_time"
                                label="实际签到时间">
                        </el-table-column>
                        <el-table-column
                                prop="sign_last_time"
                                label="签到时间">
                        </el-table-column>
                        <el-table-column
                                prop="sign_name"
                                label="签到名称">
                        </el-table-column>
                        <el-table-column
                                prop="sign_time"
                                label="签到时间">
                        </el-table-column>

                    </el-table>
                </div>
            </div>
            <div class="table-item">
                <div class="table-item-label"> 迟到签到记录</div>
                <div>
                    <el-table
                            :data="countList.signLateRecordList"
                            height="250"
                            style="width: 100%">
                        <el-table-column
                                prop="dept_name"
                                label="学院"
                        >
                        </el-table-column>
                        <el-table-column
                                prop="grade_name"
                                label="年级"
                        >
                        </el-table-column>
                        <el-table-column
                                prop="teacher_name"
                                label="老师">
                        </el-table-column>
                        <el-table-column
                                prop="kc_name"
                                label="课程">
                        </el-table-column>
                        <el-table-column
                                prop="nick_name"
                                label="姓名">
                        </el-table-column>
                        <el-table-column
                                prop="sign_create_time"
                                label="实际签到时间">
                            <template slot-scope="scope">
                                <span>{{ parseDateFull(scope.row.sign_create_time) }}</span>
                            </template>
                        </el-table-column>
                        <el-table-column
                                prop="sign_last_time"
                                label="签到时间">
                            <template slot-scope="scope">
                                <span>{{ parseDateFull(scope.row.sign_last_time) }}</span>
                            </template>
                        </el-table-column>
                        <el-table-column
                                prop="sign_name"
                                label="签到名称">
                        </el-table-column>
                        <el-table-column
                                prop="sign_time"
                                label="签到时间">
                        </el-table-column>
                    </el-table>
                </div>
            </div>
            <div class="table-item">
                <div class="table-item-label"> 正常签到记录</div>
                <div>
                    <el-table
                            :data="countList.signNormalRecordList"
                            height="250"
                            style="width: 100%">
                        <el-table-column
                                prop="dept_name"
                                label="学院"
                        >
                        </el-table-column>
                        <el-table-column
                                prop="grade_name"
                                label="年级"
                        >
                        </el-table-column>
                        <el-table-column
                                prop="teacher_name"
                                label="老师">
                        </el-table-column>
                        <el-table-column
                                prop="kc_name"
                                label="课程">
                        </el-table-column>
                        <el-table-column
                                prop="nick_name"
                                label="姓名">
                        </el-table-column>
                        <el-table-column
                                prop="sign_create_time"
                                label="实际签到时间">
                        </el-table-column>
                        <el-table-column
                                prop="sign_last_time"
                                label="签到时间">
                        </el-table-column>
                        <el-table-column
                                prop="sign_name"
                                label="签到名称">
                        </el-table-column>
                        <el-table-column
                                prop="sign_time"
                                label="签到时间">
                        </el-table-column>
                    </el-table>
                </div>
            </div>
        </div>
    </template>
</div>
</template>
</div>
<script src="element/vue.min.js"></script>
<script src="element/element.min.js"></script>
<script src="element/axios.min.js"></script>
<script>
    let vue = new Vue({
        el: '#app',
        data() {
            return {
                countMap: {},
                countList: {},
                signDate: "",
                userId: "",
                deptId: "",
                gradeId: ""
            }
        },
        mounted() {
            this.getCountData();
            this.getListData();
        },
        methods: {
            parseDateFull(time) {
                let x = new Date(time);
                let z = {
                    y: x.getFullYear(),
                    M: x.getMonth() + 1,
                    d: x.getDate(),
                    h: x.getHours(),
                    m: x.getMinutes(),
                    s: x.getSeconds(),
                };
                if (z.M < 10) {
                    z.M = "0" + z.M;
                }
                if (z.d < 10) {
                    z.d = "0" + z.d;
                }
                if (z.h < 10) {
                    z.h = "0" + z.h;
                }
                if (z.m < 10) {
                    z.m = "0" + z.m;
                }
                return z.y + "-" + z.M + "-" + z.d + " " + z.h + ":" + z.m;
            },
            getCountData() {
                let that = this;
                let params = {
                    "signDate": "",
                    "userId": "",
                    "deptId": "",
                    "gradeId": ""
                }
                axios({
                    method: 'post',
                    url: '/total/totalSign',
                    data: params
                }).then(res => {
                    console.log("countMap", res);
                    if (res.data.code == 100000) {
                        that.countMap = res.data.body;
                    } else {
                        that.$message(res.data.msg);
                    }
                }).catch(error => {
                    that.$message(error);
                });
            },
            getListData() {
                let that = this;
                let params = {
                    "signDate": "",
                    "userId": "",
                    "deptId": "",
                    "gradeId": ""
                }
                axios({
                    method: 'post',
                    url: '/total/getTotalSignList',
                    data: params
                }).then(res => {
                    console.log("countList", res);
                    if (res.data.code == 100000) {
                        that.countList = res.data.body;
                    } else {
                        that.$message(res.data.msg);
                    }
                }).catch(error => {
                    that.$message(error);
                });
            }
        },

    });

</script>
</body>
</html>